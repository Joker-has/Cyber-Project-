import nmap 
import requests
import json
import os

class SimpleVulnScanner:
    def _init_(self, target):
        self.target = target
        self.nmap = nmap.PortScanner()
        self.requests = requests.Session()

    def scan_network(self):
        # Perform network scan using Nmap
        self.nmap.scan(self.target, arguments='-sV -p 1-65535')
        results = self.nmap.all_hosts()
        for host in results:
            print(f"Host: {host}")
            for port in self.nmap[host].keys():
                print(f"  Port {port}: {self.nmap[host][port]['name']}")

    def scan_website(self):
        # Perform web scan using Requests
        try:
            response = self.requests.get(self.target)
            if response.status_code == 200:
                print(f"Website: {self.target} is online")
                # Check for outdated software versions
                if response.headers.get('Server') == 'Apache':
                    print("  Apache version: " + response.headers.get('Server'))
                elif response.headers.get('Server') == 'Nginx':
                    print("  Nginx version: " + response.headers.get('Server'))
                # Check for misconfigurations
                if response.headers.get('X-Powered-By') == 'PHP':
                    print("  PHP version: " + response.headers.get('X-Powered-By'))
                elif response.headers.get('X-Powered-By') == 'ASP':
                    print("  ASP version: " + response.headers.get('X-Powered-By'))
        except requests.exceptions.RequestException as e:
            print(f"Error: {e}")

    def run(self):
        print(f"Scanning {self.target}...")
        self.scan_network()
        self.scan_website()

if __name__ == "_main_":
    target = input("Enter the target IP or website: ")
    scanner = SimpleVulnScanner(target)
    scanner.run()